// Generated by CoffeeScript 1.6.3
(function() {
  'use strict';
  var Controller;

  Controller = (function() {
    function Controller($stateParams, newsService, $location) {
      var _this = this;
      this.kindergarten = {
        id: 1,
        name: 'school23'
      };
      this.adminUser = {
        id: 1,
        name: '豆瓣'
      };
      this.readCount = 100;
      this.news = newsService.get({
        kg: this.kindergarten.name,
        news_id: $stateParams.news
      });
      this.showEditBox = false;
      this.startEditing = function(e) {
        _this.backupContent = _this.news.content;
        e.stopPropagation();
        return _this.showEditBox = true;
      };
      this.cancelEditing = function(e) {
        e.stopPropagation();
        _this.news.content = _this.backupContent;
        return _this.showEditBox = false;
      };
      this.save = function(e) {
        e.stopPropagation();
        _this.showEditBox = false;
        if (_this.backupContent !== _this.news.content) {
          return _this.news.$save({
            kg: _this.kindergarten.name,
            news_id: _this.news.id
          });
        }
      };
      this.publish = function(news) {
        news.pushlished = true;
        return news.$save({
          kg: _this.kindergarten.name,
          news_id: news.id
        });
      };
      this.hidden = function(news) {
        news.pushlished = false;
        return news.$save({
          kg: _this.kindergarten.name,
          news_id: news.id
        });
      };
      this.editingTitle = false;
      this.backupTitle = this.news.title;
      this.saveTitle = function(e) {
        e.stopPropagation();
        _this.editingTitle = false;
        if (_this.backupTitle !== _this.news.title) {
          return _this.news.$save({
            kg: _this.kindergarten.name,
            news_id: _this.news.id
          });
        }
      };
      this.startEditingTitle = function(e) {
        e.stopPropagation();
        _this.backupTitle = _this.news.title;
        return _this.editingTitle = true;
      };
      this.deleteMe = function() {
        _this.news.$delete({
          kg: _this.kindergarten.name,
          news_id: _this.news.id
        });
        return $location.path("/kindergarten/" + _this.kindergarten.name + "/bulletin");
      };
    }

    return Controller;

  })();

  angular.module('kulebaoAdmin').controller('NewsEditCtrl', ['$stateParams', 'newsService', '$location', Controller]);

}).call(this);
